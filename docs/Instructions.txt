Instructions on using org.martus.martusjsxmlgenerator.ImportCSV
Requires Martus Version 2.9

These instructions are for converting a CSV file into an XML Martus Bulletin File which can
then can be imported into Martus using a Martus Client Tool (org.martus.client.tools.ImportXmlBulletins)

test.cvs is the flattened file extracted from a database or excel spreadsheet.
test.js is what you need to write in order to customize what the bulletin will look like
Put test.js and test.cvs in a directory (i.e. xmltest)

CD C:\xmltest

C:\Martus\bin\java.exe -cp C:\Martus\martus.jar org.martus.martusjsxmlgenerator.ImportCSV test.js test.csv "\|"


the "\|" is the delimiter | in the csv file. if the delimiter is a , just put a comma (i.e. C:\Martus\bin\java.exe -cp C:\Martus\martus.jar org.martus.martusjsxmlgenerator.ImportCSV test.js test.csv ",")


The output will be the csv file name with a .xml extension will be created ie. test.xml
 

Now that file will go into the next step. Here you must use the current Martus client jar.

C:\Martus\bin\java.exe -Xbootclasspath/p:C:\Martus\lib\ext\bc-jce.jar -cp C:\Martus\martus.jar org.martus.client.tools.ImportXmlBulletins --import-directory=C:\xmltest --account-directory=C:\Martus

 
Note this will take all xml files in the import-directory and import them into Martus.

Here is the output

Martus Bulletin XML Importer
Enter User Name:xx
Enter Password:xxx
Enter Martus folder name where you want these bulletins to be stored:imported bulletins

Importing:Bulletin #1
Importing:Bulletin #2

Finished! 2 bulletins imported into Martus.

